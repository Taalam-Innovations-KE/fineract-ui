services:
  fineract-ui:
    image: taalamke/taalam-fincore-web:latest
    container_name: fineract-ui
    restart: unless-stopped
    expose:
      - "3000"
    environment:
      NODE_ENV: "production"
      AUTH_URL: "https://your-ui-domain.example"
      NEXTAUTH_URL: "https://your-ui-domain.example"
      AUTH_SECRET: "replace-with-strong-secret"
      FINERACT_BASE_URL: "https://your-fineract-domain.example/fineract-provider/api"
      FINERACT_USERNAME: "mifos"
      FINERACT_PASSWORD: "password"
      AUTH_KEYCLOAK_ID: "your-keycloak-client-id"
      AUTH_KEYCLOAK_SECRET: "your-keycloak-client-secret"
      AUTH_KEYCLOAK_ISSUER: "https://your-keycloak-domain.example/realms/your-realm"
    networks:
      - fincore
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.fincore.rule=Host(`your-ui-domain.example`)"
      - "traefik.http.routers.fincore.entrypoints=websecure"
      - "traefik.http.routers.fincore.tls.certresolver=letsencrypt"
      - "traefik.http.services.fincore.loadbalancer.server.port=3000"

  traefik:
    image: traefik:v3.1
    container_name: fincore-traefik
    restart: unless-stopped
    depends_on:
      - fineract-ui
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock:ro
      - ./traefik/traefik.yml:/etc/traefik/traefik.yml:ro
      - ./traefik/acme.json:/acme.json
    networks:
      - fincore

networks:
  fincore:
    driver: bridge
